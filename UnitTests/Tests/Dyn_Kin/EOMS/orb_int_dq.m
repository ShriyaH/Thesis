function dY = orb_int_dq(T,Y)       
    m = 2108.3836;
    mu = 174620600;
    dI = [0 0 0 0 2108.38360137571 0 0 0;0 0 0 0 0 2108.38360137571 0 0;0 0 0 0 0 0 2108.38360137571 0;0 0 0 0 0 0 0 1;16638.7149212849 0 0 0 0 0 0 0;0 2072.19825461825 0 0 0 0 0 0;0 0 15462.0462703546 0 0 0 0 0;0 0 0 1 0 0 0 0]; 
    dI_inv =[0 0 0 0 6.01007953276945e-05 0 0 0;0 0 0 0 0 0.000482579308119447 0 0;0 0 0 0 0 0 6.46744927880148e-05 0;0 0 0 0 0 0 0 1;0.000474296991945633 0 0 0 0 0 0 0;0 0.000474296991945633 0 0 0 0 0 0;0 0 0.000474296991945633 0 0 0 0 0;0 0 0 1 0 0 0 0];
    w_AI = [0; 0; 3.2411e-04];
    T_D = [0; 0; 0; 0];
    B = [1 0 0 0 0 0 0 0;0 1 0 0 0 0 0 0;0 0 1 0 0 0 0 0;0 0 0 1 0 0 0 0;0 0 0 0 2 0 0 0;0 0 0 0 0 2 0 0;0 0 0 0 0 0 2 0;0 0 0 0 0 0 0 1];
    
    Y(1:8) = dq_norm(Y(1:8));
    
    dq_W = omega_tensor(Y(9:16),3); %dq cross product matrix
    dq_dot = 0.5*dq_W*Y(1:8); 
    
    d_W = omega_tensor(Y(9:16),4); %dual number cross product matrix
    C_BA = Q2DCM(Y(1:4));
    
    w_AI_B = C_BA * w_AI; 
    dq_w_AI_B = [w_AI_B; zeros(5,1)];
    W_AI_B = omega_tensor(dq_w_AI_B,4);
    W_AI_B2 =  W_AI_B;
    W_AI_B2(1:4,1:4) = [w_AI_B(1) 0 0 0; 0 w_AI_B(2) 0 0; 0 0 w_AI_B(3) 0; 0 0 0 0];

    r_B = 2.*cross_quat(Y(5:8),conj_quat(Y(1:4)));
    r = norm(r_B);
    F_B = -(m*mu).*r_B(1:3)./r^3;
    dF_B = [F_B; 0; T_D];
    
    A = [ones(3,1); 0; r_B(1:3); 0];
    
    dw_dot = dI_inv * (dF_B - d_W*(dI*Y(9:16)) - W_AI_B*(dI*(W_AI_B2*A))) - B*W_AI_B * Y(9:16); %omega_BA dot

    dY = [dq_dot; dw_dot];
end
                                                                                                        
