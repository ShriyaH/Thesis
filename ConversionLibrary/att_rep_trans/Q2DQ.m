function [dq] = Q2DQ(q,r,i)
%%get dq from the rotation quaternion (q) and translation vector (r)
%%seq 1 or 2 determines whether translation then rotation or vice versa
%%resp.

if size(r) == [1,3]
    p = [r';0]; %Pure DQ form of vector to be transformed
elseif size(r) == [3,1]
	p = [r;0]; %Pure DQ form of vector to be transformed
elseif size(r) == [1,4]
	p = r';
elseif size(r) == [4,1]
	p = r;
end

if norm(q) == 1
    q_r = q;
else
    q_norm = norm(q);
    q_r = q/q_norm;
end 

switch i
    case 1
        q_d = 0.5 .*cross_quat(p,q_r);    
    case 2
        q_d = 0.5 .*cross_quat(q_r,p);
    otherwise
        disp('Wrong input for order of transformation');
end 

dq = [q_r;q_d];
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
end